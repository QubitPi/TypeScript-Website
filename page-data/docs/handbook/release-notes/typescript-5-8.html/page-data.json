{"componentChunkName":"component---src-templates-documentation-tsx","path":"/docs/handbook/release-notes/typescript-5-8.html","result":{"data":{"markdownRemark":{"id":"bac46792-a178-5475-8462-4db56c780484","excerpt":"Granular Checks for Branches in Return Expressions Consider some code like the following: The intent of this code is to retrieve a URL object from a cache if it…","html":"<h2 id=\"granular-checks-for-branches-in-return-expressions\" style=\"position:relative;\"><a href=\"#granular-checks-for-branches-in-return-expressions\" aria-label=\"granular checks for branches in return expressions permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Granular Checks for Branches in Return Expressions</h2>\n<p>Consider some code like the following:</p>\n<pre class=\"shiki light-plus\" style=\"background-color: #FFFFFF; color: #000000\"><div class=\"language-id\">ts</div><div class='code-container' tabindex='0'><code><div class='line'><span style=\"color: #0000FF\">declare</span><span style=\"color: #000000\"> </span><span style=\"color: #0000FF\">const</span><span style=\"color: #000000\"> </span><span style=\"color: #0070C1\">untypedCache</span><span style=\"color: #000000\">: </span><span style=\"color: #1C6277\">Map</span><span style=\"color: #000000\">&lt;</span><span style=\"color: #1C6277\">any</span><span style=\"color: #000000\">, </span><span style=\"color: #1C6277\">any</span><span style=\"color: #000000\">&gt;;</span></div><div class='line'></div><div class='line'><span style=\"color: #0000FF\">function</span><span style=\"color: #000000\"> </span><span style=\"color: #795E26\">getUrlObject</span><span style=\"color: #000000\">(</span><span style=\"color: #001080\">urlString</span><span style=\"color: #000000\">: </span><span style=\"color: #1C6277\">string</span><span style=\"color: #000000\">): </span><span style=\"color: #1C6277\">URL</span><span style=\"color: #000000\"> {</span></div><div class='line'><span style=\"color: #000000\">    </span><span style=\"color: #AF00DB\">return</span><span style=\"color: #000000\"> </span><span style=\"color: #001080\">untypedCache</span><span style=\"color: #000000\">.</span><span style=\"color: #795E26\">has</span><span style=\"color: #000000\">(</span><span style=\"color: #001080\">urlString</span><span style=\"color: #000000\">) ?</span></div><div class='line'><span style=\"color: #000000\">        </span><span style=\"color: #001080\">untypedCache</span><span style=\"color: #000000\">.</span><span style=\"color: #795E26\">get</span><span style=\"color: #000000\">(</span><span style=\"color: #001080\">urlString</span><span style=\"color: #000000\">) :</span></div><div class='line'><span style=\"color: #000000\">        </span><span style=\"color: #001080\">urlString</span><span style=\"color: #000000\">;</span></div><div class='line'><span style=\"color: #000000\">}</span></div></code></div></pre>\n<p>The intent of this code is to retrieve a URL object from a cache if it exists, or to create a new URL object if it doesn’t.\nHowever, there’s a bug: we forgot to actually construct a new URL object with the input.\nUnfortunately, TypeScript generally didn’t catch this sort of bug.</p>\n<p>When TypeScript checks conditional expressions like <code>cond ? trueBranch : falseBranch</code>, its type is treated as a union of the types of the two branches.\nIn other words, it gets the type of <code>trueBranch</code> and <code>falseBranch</code>, and combines them into a union type.\nIn this case, the type of <code>untypedCache.get(urlString)</code> is <code>any</code>, and the type of <code>urlString</code> is <code>string</code>.\nThis is where things go wrong because <code>any</code> is so infectious in how it interacts with other types.\nThe union <code>any | string</code> is simplified to <code>any</code>, so by the time TypeScript starts checking whether the expression in our <code>return</code> statement is compatible with the expected return type of <code>URL</code>, the type system has lost any information that would have caught the bug in this code.</p>\n<p>In TypeScript 5.8, the type system special-cases conditional expressions directly inside <code>return</code> statements.\nEach branch of the conditional is checked against the declared return type of the containing functions (if one exists), so the type system can catch the bug in the example above.</p>\n<pre class=\"shiki light-plus\" style=\"background-color: #FFFFFF; color: #000000\"><div class=\"language-id\">ts</div><div class='code-container' tabindex='0'><code><div class='line'><span style=\"color: #0000FF\">declare</span><span style=\"color: #000000\"> </span><span style=\"color: #0000FF\">const</span><span style=\"color: #000000\"> </span><span style=\"color: #0070C1\">untypedCache</span><span style=\"color: #000000\">: </span><span style=\"color: #1C6277\">Map</span><span style=\"color: #000000\">&lt;</span><span style=\"color: #1C6277\">any</span><span style=\"color: #000000\">, </span><span style=\"color: #1C6277\">any</span><span style=\"color: #000000\">&gt;;</span></div><div class='line'></div><div class='line'><span style=\"color: #0000FF\">function</span><span style=\"color: #000000\"> </span><span style=\"color: #795E26\">getUrlObject</span><span style=\"color: #000000\">(</span><span style=\"color: #001080\">urlString</span><span style=\"color: #000000\">: </span><span style=\"color: #1C6277\">string</span><span style=\"color: #000000\">): </span><span style=\"color: #1C6277\">URL</span><span style=\"color: #000000\"> {</span></div><div class='line'><span style=\"color: #000000\">    </span><span style=\"color: #AF00DB\">return</span><span style=\"color: #000000\"> </span><span style=\"color: #001080\">untypedCache</span><span style=\"color: #000000\">.</span><span style=\"color: #795E26\">has</span><span style=\"color: #000000\">(</span><span style=\"color: #001080\">urlString</span><span style=\"color: #000000\">) ?</span></div><div class='line'><span style=\"color: #000000\">        </span><span style=\"color: #001080\">untypedCache</span><span style=\"color: #000000\">.</span><span style=\"color: #795E26\">get</span><span style=\"color: #000000\">(</span><span style=\"color: #001080\">urlString</span><span style=\"color: #000000\">) :</span></div><div class='line'><span style=\"color: #000000\">        </span><span style=\"color: #001080\">urlString</span><span style=\"color: #000000\">;</span></div><div class='line'><span style=\"color: #000000\">    </span><span style=\"color: #008000\">//  ~~~~~~~~~</span></div><div class='line'><span style=\"color: #000000\">    </span><span style=\"color: #008000\">// error! Type 'string' is not assignable to type 'URL'.</span></div><div class='line'><span style=\"color: #000000\">}</span></div></code></div></pre>\n<p>This change was made <a href=\"https://github.com/microsoft/TypeScript/pull/56941\">within this pull request</a>, as part of a broader set of future improvements for TypeScript.</p>\n<h2 id=\"support-for-require-of-ecmascript-modules-in---module-nodenext\" style=\"position:relative;\"><a href=\"#support-for-require-of-ecmascript-modules-in---module-nodenext\" aria-label=\"support for require of ecmascript modules in   module nodenext permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Support for <code>require()</code> of ECMAScript Modules in <code>--module nodenext</code></h2>\n<p>For years, Node.js supported ECMAScript modules (ESM) alongside CommonJS modules.\nUnfortunately, the interoperability between the two had some challenges.</p>\n<ul>\n<li>ESM files could <code>import</code> CommonJS files</li>\n<li>CommonJS files <em><strong>could not</strong></em> <code>require()</code> ESM files</li>\n</ul>\n<p>In other words, consuming CommonJS files from ESM files was possible, but not the other way around.\nThis introduced many challenges for library authors who wanted to provide ESM support.\nThese library authors would either have to break compatibility with CommonJS users, “dual-publish” their libraries (providing separate entry-points for ESM and CommonJS), or just stay on CommonJS indefinitely.\nWhile dual-publishing might sound like a good middle-ground, it is a complex and error-prone process that also roughly doubles the amount of code within a package.</p>\n<p>Node.js 22 relaxes some of these restrictions and permits <code>require(\"esm\")</code> calls from CommonJS modules to ECMAScript modules.\nNode.js still does not permit <code>require()</code> on ESM files that contain a top-level <code>await</code>, but most other ESM files are now consumable from CommonJS files.\nThis presents a major opportunity for library authors to provide ESM support without having to dual-publish their libraries.</p>\n<p>TypeScript 5.8 supports this behavior under the <code>--module nodenext</code> flag.\nWhen <code>--module nodenext</code> is enabled, TypeScript will avoid issuing errors on these <code>require()</code> calls to ESM files.</p>\n<p>Because this feature may be back-ported to older versions of Node.js, there is currently no stable <code>--module nodeXXXX</code> option that enables this behavior;\nhowever, we predict future versions of TypeScript may be able to stabilize the feature under <code>node20</code>.\nIn the meantime, we encourage users of Node.js 22 and newer to use <code>--module nodenext</code>, while library authors and users of older Node.js versions should remain on <code>--module node16</code> (or make the minor update to <a href=\"#--module-node18\"><code>--module node18</code></a>).</p>\n<p>For more information, <a href=\"https://github.com/microsoft/TypeScript/pull/60761\">see our support for require(“esm”) here</a>.</p>\n<h2 id=\"--module-node18\" style=\"position:relative;\"><a href=\"#--module-node18\" aria-label=\"  module node18 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code>--module node18</code></h2>\n<p>TypeScript 5.8 introduces a stable <code>--module node18</code> flag.\nFor users who are fixed on using Node.js 18, this flag provides a stable point of reference that does not incorporate certain behaviors that are in <code>--module nodenext</code>.\nSpecifically:</p>\n<ul>\n<li><code>require()</code> of ECMAScript modules is disallowed under <code>node18</code>, but allowed under <code>nodenext</code></li>\n<li>import assertions (deprecated in favor of import attributes) are allowed under <code>node18</code>, but are disallowed under <code>nodenext</code></li>\n</ul>\n<p>See more at both <a href=\"https://github.com/microsoft/TypeScript/pull/60722\">the <code>--module node18</code> pull request</a> and <a href=\"https://github.com/microsoft/TypeScript/pull/60761\">changes made to <code>--module nodenext</code></a>.</p>\n<h2 id=\"the---erasablesyntaxonly-option\" style=\"position:relative;\"><a href=\"#the---erasablesyntaxonly-option\" aria-label=\"the   erasablesyntaxonly option permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The <code>--erasableSyntaxOnly</code> Option</h2>\n<p>Recently, Node.js 23.6 unflagged <a href=\"https://nodejs.org/api/typescript.html#type-stripping\">experimental support for running TypeScript files directly</a>;\nhowever, only certain constructs are supported under this mode.\nNode.js has unflagged a mode called <code>--experimental-strip-types</code> which requires that any TypeScript-specific syntax cannot have runtime semantics.\nPhrased differently, it must be possible to easily <em>erase</em> or “strip out” any TypeScript-specific syntax from a file, leaving behind a valid JavaScript file.</p>\n<p>That means constructs like the following are not supported:</p>\n<ul>\n<li><code>enum</code> declarations</li>\n<li><code>namespace</code>s and <code>module</code>s with runtime code</li>\n<li>parameter properties in classes</li>\n<li>Non-ECMAScript <code>import =</code> and <code>export =</code> assignments</li>\n</ul>\n<p>Here are some examples of what does not work:</p>\n<pre class=\"shiki light-plus\" style=\"background-color: #FFFFFF; color: #000000\"><div class=\"language-id\">ts</div><div class='code-container' tabindex='0'><code><div class='line'><span style=\"color: #008000\">// ❌ error: An `import ... = require(...)` alias</span></div><div class='line'><span style=\"color: #AF00DB\">import</span><span style=\"color: #000000\"> </span><span style=\"color: #001080\">foo</span><span style=\"color: #000000\"> = </span><span style=\"color: #AF00DB\">require</span><span style=\"color: #000000\">(</span><span style=\"color: #A31515\">\"foo\"</span><span style=\"color: #000000\">);</span></div><div class='line'></div><div class='line'><span style=\"color: #008000\">// ❌ error: A namespace with runtime code.</span></div><div class='line'><span style=\"color: #0000FF\">namespace</span><span style=\"color: #000000\"> </span><span style=\"color: #1C6277\">container</span><span style=\"color: #000000\"> {</span></div><div class='line'><span style=\"color: #000000\">}</span></div><div class='line'></div><div class='line'><span style=\"color: #008000\">// ❌ error: An `import =` alias</span></div><div class='line'><span style=\"color: #AF00DB\">import</span><span style=\"color: #000000\"> </span><span style=\"color: #001080\">Bar</span><span style=\"color: #000000\"> = </span><span style=\"color: #1C6277\">container</span><span style=\"color: #000000\">.</span><span style=\"color: #001080\">Bar</span><span style=\"color: #000000\">;</span></div><div class='line'></div><div class='line'><span style=\"color: #0000FF\">class</span><span style=\"color: #000000\"> </span><span style=\"color: #1C6277\">Point</span><span style=\"color: #000000\"> {</span></div><div class='line'><span style=\"color: #000000\">    </span><span style=\"color: #008000\">// ❌ error: Parameter properties</span></div><div class='line'><span style=\"color: #000000\">    </span><span style=\"color: #0000FF\">constructor</span><span style=\"color: #000000\">(</span><span style=\"color: #0000FF\">public</span><span style=\"color: #000000\"> </span><span style=\"color: #001080\">x</span><span style=\"color: #000000\">: </span><span style=\"color: #1C6277\">number</span><span style=\"color: #000000\">, </span><span style=\"color: #0000FF\">public</span><span style=\"color: #000000\"> </span><span style=\"color: #001080\">y</span><span style=\"color: #000000\">: </span><span style=\"color: #1C6277\">number</span><span style=\"color: #000000\">) { }</span></div><div class='line'><span style=\"color: #000000\">}</span></div><div class='line'></div><div class='line'><span style=\"color: #008000\">// ❌ error: An `export =` assignment.</span></div><div class='line'><span style=\"color: #AF00DB\">export</span><span style=\"color: #000000\"> = </span><span style=\"color: #001080\">Point</span><span style=\"color: #000000\">;</span></div><div class='line'></div><div class='line'><span style=\"color: #008000\">// ❌ error: An enum declaration.</span></div><div class='line'><span style=\"color: #0000FF\">enum</span><span style=\"color: #000000\"> </span><span style=\"color: #1C6277\">Direction</span><span style=\"color: #000000\"> {</span></div><div class='line'><span style=\"color: #000000\">    </span><span style=\"color: #0070C1\">Up</span><span style=\"color: #000000\">,</span></div><div class='line'><span style=\"color: #000000\">    </span><span style=\"color: #0070C1\">Down</span><span style=\"color: #000000\">,</span></div><div class='line'><span style=\"color: #000000\">    </span><span style=\"color: #0070C1\">Left</span><span style=\"color: #000000\">,</span></div><div class='line'><span style=\"color: #000000\">    </span><span style=\"color: #0070C1\">Right</span><span style=\"color: #000000\">,</span></div><div class='line'><span style=\"color: #000000\">}</span></div></code></div></pre>\n<p>Similar tools like <a href=\"https://github.com/bloomberg/ts-blank-space\">ts-blank-space</a> or <a href=\"https://github.com/nodejs/amaro\">Amaro</a> (the underlying library for type-stripping in Node.js) have the same limitations.\nThese tools will provide helpful error messages if they encounter code that doesn’t meet these requirements, but you still won’t find out your code doesn’t work until you actually try to run it.</p>\n<p>That’s why TypeScript 5.8 introduces the <code>--erasableSyntaxOnly</code> flag.\nWhen this flag is enabled, TypeScript will error on most TypeScript-specific constructs that have runtime behavior.</p>\n<pre class=\"shiki light-plus\" style=\"background-color: #FFFFFF; color: #000000\"><div class=\"language-id\">ts</div><div class='code-container' tabindex='0'><code><div class='line'><span style=\"color: #0000FF\">class</span><span style=\"color: #000000\"> </span><span style=\"color: #1C6277\">C</span><span style=\"color: #000000\"> {</span></div><div class='line'><span style=\"color: #000000\">    </span><span style=\"color: #0000FF\">constructor</span><span style=\"color: #000000\">(</span><span style=\"color: #0000FF\">public</span><span style=\"color: #000000\"> </span><span style=\"color: #001080\">x</span><span style=\"color: #000000\">: </span><span style=\"color: #1C6277\">number</span><span style=\"color: #000000\">) { }</span></div><div class='line'><span style=\"color: #000000\">    </span><span style=\"color: #008000\">//          ~~~~~~~~~~~~~~~~</span></div><div class='line'><span style=\"color: #000000\">    </span><span style=\"color: #008000\">// error! This syntax is not allowed when 'erasableSyntaxOnly' is enabled.</span></div><div class='line'><span style=\"color: #000000\">    }</span></div><div class='line'><span style=\"color: #000000\">}</span></div></code></div></pre>\n<p>Typically, you will want to combine this flag with the <code>--verbatimModuleSyntax</code>, which ensures that a module contains the appropriate import syntax, and that import elision does not take place.</p>\n<p>For more information, <a href=\"https://github.com/microsoft/TypeScript/pull/61011\">see the implementation here</a>.</p>\n<h2 id=\"the---libreplacement-flag\" style=\"position:relative;\"><a href=\"#the---libreplacement-flag\" aria-label=\"the   libreplacement flag permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The <code>--libReplacement</code> Flag</h2>\n<p>In TypeScript 4.5, we introduced the possibility of substituting the default <code>lib</code> files with custom ones.\nThis was based on the possibility of resolving a library file from packages named <code>@typescript/lib-*</code>.\nFor example, you could lock your <code>dom</code> libraries onto a specific version of <a href=\"https://www.npmjs.com/package/@types/web?activeTab=readme\">the <code>@types/web</code> package</a> with the following <code>package.json</code>:</p>\n<pre class=\"shiki light-plus\" style=\"background-color: #FFFFFF; color: #000000\"><div class=\"language-id\">json</div><div class='code-container' tabindex='0'><code><div class='line'><span style=\"color: #000000\">{</span></div><div class='line'><span style=\"color: #000000\">    </span><span style=\"color: #0451A5\">\"devDependencies\"</span><span style=\"color: #000000\">: {</span></div><div class='line'><span style=\"color: #000000\">       </span><span style=\"color: #0451A5\">\"@typescript/lib-dom\"</span><span style=\"color: #000000\">: </span><span style=\"color: #A31515\">\"npm:@types/web@0.0.199\"</span></div><div class='line'><span style=\"color: #000000\">     }</span></div><div class='line'><span style=\"color: #000000\">}</span></div></code></div></pre>\n<p>When installed, a package called <code>@typescript/lib-dom</code> should exist, and TypeScript will currently always look it up when <code>dom</code> is implied by your settings.</p>\n<p>This is a powerful feature, but it also incurs a bit of extra work.\nEven if you’re not using this feature, TypeScript always performs this lookup, and has to watch for changes in <code>node_modules</code> in case a <code>lib</code>-replacement package <em>begins</em> to exist.</p>\n<p>TypeScript 5.8 introduces the <code>--libReplacement</code> flag, which allows you to disable this behavior.\nIf you’re not using <code>--libReplacement</code>, you can now disable it with <code>--libReplacement false</code>.\nIn the future <code>--libReplacement false</code> may become the default, so if you currently rely on the behavior you should consider explicitly enabling it with <code>--libReplacement true</code>.</p>\n<p>For more information, <a href=\"https://github.com/microsoft/TypeScript/issues/61023\">see the change here</a>.</p>\n<h2 id=\"preserved-computed-property-names-in-declaration-files\" style=\"position:relative;\"><a href=\"#preserved-computed-property-names-in-declaration-files\" aria-label=\"preserved computed property names in declaration files permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Preserved Computed Property Names in Declaration Files</h2>\n<p>In an effort to make computed properties have more predictable emit in declaration files, TypeScript 5.8 will consistently preserve entity names (<code>bareVariables</code> and <code>dotted.names.that.look.like.this</code>) in computed property names in classes.</p>\n<p>For example, consider the following code:</p>\n<pre class=\"shiki light-plus\" style=\"background-color: #FFFFFF; color: #000000\"><div class=\"language-id\">ts</div><div class='code-container' tabindex='0'><code><div class='line'><span style=\"color: #AF00DB\">export</span><span style=\"color: #000000\"> </span><span style=\"color: #0000FF\">let</span><span style=\"color: #000000\"> </span><span style=\"color: #001080\">propName</span><span style=\"color: #000000\"> = </span><span style=\"color: #A31515\">\"theAnswer\"</span><span style=\"color: #000000\">;</span></div><div class='line'></div><div class='line'><span style=\"color: #AF00DB\">export</span><span style=\"color: #000000\"> </span><span style=\"color: #0000FF\">class</span><span style=\"color: #000000\"> </span><span style=\"color: #1C6277\">MyClass</span><span style=\"color: #000000\"> {</span></div><div class='line'><span style=\"color: #000000\">    [</span><span style=\"color: #001080\">propName</span><span style=\"color: #000000\">] = </span><span style=\"color: #098658\">42</span><span style=\"color: #000000\">;</span></div><div class='line'><span style=\"color: #008000\">//  ~~~~~~~~~~</span></div><div class='line'><span style=\"color: #008000\">// error!</span></div><div class='line'><span style=\"color: #008000\">// A computed property name in a class property declaration must have a simple literal type or a 'unique symbol' type.</span></div><div class='line'><span style=\"color: #000000\">}</span></div></code></div></pre>\n<p>Previous versions of TypeScript would issue an error when generating a declaration file for this module, and a best-effort declaration file would generate an index signature.</p>\n<pre class=\"shiki light-plus\" style=\"background-color: #FFFFFF; color: #000000\"><div class=\"language-id\">ts</div><div class='code-container' tabindex='0'><code><div class='line'><span style=\"color: #AF00DB\">export</span><span style=\"color: #000000\"> </span><span style=\"color: #0000FF\">declare</span><span style=\"color: #000000\"> </span><span style=\"color: #0000FF\">let</span><span style=\"color: #000000\"> </span><span style=\"color: #001080\">propName</span><span style=\"color: #000000\">: </span><span style=\"color: #1C6277\">string</span><span style=\"color: #000000\">;</span></div><div class='line'><span style=\"color: #AF00DB\">export</span><span style=\"color: #000000\"> </span><span style=\"color: #0000FF\">declare</span><span style=\"color: #000000\"> </span><span style=\"color: #0000FF\">class</span><span style=\"color: #000000\"> </span><span style=\"color: #1C6277\">MyClass</span><span style=\"color: #000000\"> {</span></div><div class='line'><span style=\"color: #000000\">    [</span><span style=\"color: #001080\">x</span><span style=\"color: #000000\">: </span><span style=\"color: #1C6277\">string</span><span style=\"color: #000000\">]: </span><span style=\"color: #1C6277\">number</span><span style=\"color: #000000\">;</span></div><div class='line'><span style=\"color: #000000\">}</span></div></code></div></pre>\n<p>In TypeScript 5.8, the example code is now allowed, and the emitted declaration file will match what you wrote:</p>\n<pre class=\"shiki light-plus\" style=\"background-color: #FFFFFF; color: #000000\"><div class=\"language-id\">ts</div><div class='code-container' tabindex='0'><code><div class='line'><span style=\"color: #AF00DB\">export</span><span style=\"color: #000000\"> </span><span style=\"color: #0000FF\">declare</span><span style=\"color: #000000\"> </span><span style=\"color: #0000FF\">let</span><span style=\"color: #000000\"> </span><span style=\"color: #001080\">propName</span><span style=\"color: #000000\">: </span><span style=\"color: #1C6277\">string</span><span style=\"color: #000000\">;</span></div><div class='line'><span style=\"color: #AF00DB\">export</span><span style=\"color: #000000\"> </span><span style=\"color: #0000FF\">declare</span><span style=\"color: #000000\"> </span><span style=\"color: #0000FF\">class</span><span style=\"color: #000000\"> </span><span style=\"color: #1C6277\">MyClass</span><span style=\"color: #000000\"> {</span></div><div class='line'><span style=\"color: #000000\">    [</span><span style=\"color: #001080\">propName</span><span style=\"color: #000000\">]: </span><span style=\"color: #1C6277\">number</span><span style=\"color: #000000\">;</span></div><div class='line'><span style=\"color: #000000\">}</span></div></code></div></pre>\n<p>Note that this does not create statically-named properties on the class.\nYou’ll still end up with what is effectively an index signature like <code>[x: string]: number</code>, so for that use case, you’d need to use <code>unique symbol</code>s or literal types.</p>\n<p>Note that writing this code was and currently is an error under the <code>--isolatedDeclarations</code> flag;\nbut we expect that thanks to this change, computed property names will generally be permitted in declaration emit.</p>\n<p>Note that it’s possible (though unlikely) that a file compiled in TypeScript 5.8 may generate a declaration file that is not backward compatible in TypeScript 5.7 or earlier.</p>\n<p>For more information, <a href=\"https://github.com/microsoft/TypeScript/pull/60052\">see the implementing PR</a>.</p>\n<h2 id=\"optimizations-on-program-loads-and-updates\" style=\"position:relative;\"><a href=\"#optimizations-on-program-loads-and-updates\" aria-label=\"optimizations on program loads and updates permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Optimizations on Program Loads and Updates</h2>\n<p>TypeScript 5.8 introduces a number of optimizations that can both improve the time to build up a program, and also to update a program based on a file change in either <code>--watch</code> mode or editor scenarios.</p>\n<p>First, TypeScript now <a href=\"https://github.com/microsoft/TypeScript/pull/60812\">avoids array allocations that would be involved while normalizing paths</a>.\nTypically, path normalization would involve segmenting each portion of a path into an array of strings, normalizing the resulting path based on relative segments, and then joining them back together using a canonical separator.\nFor projects with many files, this can be a significant and repetitive amount of work.\nTypeScript now avoids allocating an array, and operates more directly on indexes of the original path.</p>\n<p>Additionally, when edits are made that don’t change the fundamental structure of a project, <a href=\"https://github.com/microsoft/TypeScript/pull/60754\">TypeScript now avoids re-validating the options provided to it</a> (e.g. the contents of a <code>tsconfig.json</code>).\nThis means, for example, that a simple edit might not require checking that the output paths of a project don’t conflict with the input paths.\nInstead, the results of the last check can be used.\nThis should make edits in large projects feel more responsive.</p>\n<h2 id=\"notable-behavioral-changes\" style=\"position:relative;\"><a href=\"#notable-behavioral-changes\" aria-label=\"notable behavioral changes permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Notable Behavioral Changes</h2>\n<p>This section highlights a set of noteworthy changes that should be acknowledged and understood as part of any upgrade.\nSometimes it will highlight deprecations, removals, and new restrictions.\nIt can also contain bug fixes that are functionally improvements, but which can also affect an existing build by introducing new errors.</p>\n<h3 id=\"libdts\" style=\"position:relative;\"><a href=\"#libdts\" aria-label=\"libdts permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code>lib.d.ts</code></h3>\n<p>Types generated for the DOM may have an impact on type-checking your codebase.\nFor more information, <a href=\"https://github.com/microsoft/TypeScript/issues/60985\">see linked issues related to DOM and <code>lib.d.ts</code> updates for this version of TypeScript</a>.</p>\n<h3 id=\"restrictions-on-import-assertions-under---module-nodenext\" style=\"position:relative;\"><a href=\"#restrictions-on-import-assertions-under---module-nodenext\" aria-label=\"restrictions on import assertions under   module nodenext permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Restrictions on Import Assertions Under <code>--module nodenext</code></h3>\n<p>Import assertions were a proposed addition to ECMAScript to ensure certain properties of an import (e.g. “this module is JSON, and is not intended to be executable JavaScript code”).\nThey were reinvented as a proposal called <a href=\"https://github.com/tc39/proposal-import-attributes\">import attributes</a>.\nAs part of the transition, they swapped from using the <code>assert</code> keyword to using the <code>with</code> keyword.</p>\n<pre class=\"shiki light-plus\" style=\"background-color: #FFFFFF; color: #000000\"><div class=\"language-id\">ts</div><div class='code-container' tabindex='0'><code><div class='line'><span style=\"color: #008000\">// An import assertion ❌ - not future-compatible with most runtimes.</span></div><div class='line'><span style=\"color: #AF00DB\">import</span><span style=\"color: #000000\"> </span><span style=\"color: #001080\">data</span><span style=\"color: #000000\"> </span><span style=\"color: #AF00DB\">from</span><span style=\"color: #000000\"> </span><span style=\"color: #A31515\">\"./data.json\"</span><span style=\"color: #000000\"> </span><span style=\"color: #001080\">assert</span><span style=\"color: #000000\"> { </span><span style=\"color: #001080\">type</span><span style=\"color: #000000\">: \"</span><span style=\"color: #001080\">json</span><span style=\"color: #000000\">\" };</span></div><div class='line'></div><div class='line'><span style=\"color: #008000\">// An import attribute ✅ - the preferred way to import a JSON file.</span></div><div class='line'><span style=\"color: #AF00DB\">import</span><span style=\"color: #000000\"> </span><span style=\"color: #001080\">data</span><span style=\"color: #000000\"> </span><span style=\"color: #AF00DB\">from</span><span style=\"color: #000000\"> </span><span style=\"color: #A31515\">\"./data.json\"</span><span style=\"color: #000000\"> </span><span style=\"color: #001080\">with</span><span style=\"color: #000000\"> { </span><span style=\"color: #001080\">type</span><span style=\"color: #000000\">: \"</span><span style=\"color: #001080\">json</span><span style=\"color: #000000\">\" };</span></div></code></div></pre>\n<p>Node.js 22 no longer accepts import assertions using the <code>assert</code> syntax.\nIn turn when <code>--module nodenext</code> is enabled in TypeScript 5.8, TypeScript will issue an error if it encounters an import assertion.</p>\n<pre class=\"shiki light-plus\" style=\"background-color: #FFFFFF; color: #000000\"><div class=\"language-id\">ts</div><div class='code-container' tabindex='0'><code><div class='line'><span style=\"color: #AF00DB\">import</span><span style=\"color: #000000\"> </span><span style=\"color: #001080\">data</span><span style=\"color: #000000\"> </span><span style=\"color: #AF00DB\">from</span><span style=\"color: #000000\"> </span><span style=\"color: #A31515\">\"./data.json\"</span><span style=\"color: #000000\"> </span><span style=\"color: #001080\">assert</span><span style=\"color: #000000\"> { </span><span style=\"color: #001080\">type</span><span style=\"color: #000000\">: \"</span><span style=\"color: #001080\">json</span><span style=\"color: #000000\">\" };</span></div><div class='line'><span style=\"color: #008000\">//                             ~~~~~~</span></div><div class='line'><span style=\"color: #008000\">// error! Import assertions have been replaced by import attributes. Use 'with' instead of 'assert'</span></div></code></div></pre>\n<p>For more information, <a href=\"https://github.com/microsoft/TypeScript/pull/60761\">see the change here</a></p>","headings":[{"value":"Granular Checks for Branches in Return Expressions","depth":2},{"value":"Support for require() of ECMAScript Modules in --module nodenext","depth":2},{"value":"--module node18","depth":2},{"value":"The --erasableSyntaxOnly Option","depth":2},{"value":"The --libReplacement Flag","depth":2},{"value":"Preserved Computed Property Names in Declaration Files","depth":2},{"value":"Optimizations on Program Loads and Updates","depth":2},{"value":"Notable Behavioral Changes","depth":2},{"value":"lib.d.ts","depth":3},{"value":"Restrictions on Import Assertions Under --module nodenext","depth":3}],"frontmatter":{"permalink":"/docs/handbook/release-notes/typescript-5-8.html","title":"TypeScript 5.8","disable_toc":null,"handbook":null,"oneline":"TypeScript 5.8 Release Notes","preamble":null,"deprecated_by":null,"deprecation_redirects":null,"experimental":null}},"prev":null,"next":null},"pageContext":{"id":"5-typescript-5.8","slug":"/docs/handbook/release-notes/typescript-5-8.html","repoPath":"/packages/documentation/copy/en/release-notes/TypeScript 5.8.md","previousID":null,"nextID":null,"lang":"en","modifiedTime":"2025-08-08T16:41:23.053Z"}},"staticQueryHashes":[],"slicesMap":{}}